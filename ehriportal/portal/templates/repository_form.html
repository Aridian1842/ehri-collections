{% extends "site_base.html" %}

{% load i18n %}
{% load ifsetting_tag %}
{% load markup %}
{% load portal_tags %}
{% load bootstrap_tags %}

{% block head_title %}
    {% if object %}
        {% trans "Edit Repository" %} - {{object.name}}
    {% else %}
        {% trans "Create Repository" %}
    {% endif %}
{% endblock %}

{% block body %}
<h1>{{object.name}}</h1>
<div class="row">
    <div class="span12">
        <form method="post" class="entity-form form-horizontal" id="collection-edit-form">
            {% csrf_token %}
            <fieldset>
                <legend>Identity Area</legend>
                {% include "_form_field.html" with field=form.identifier %}
                {% include "_form_field.html" with field=form.name %}

                <div class="dynamic-formset" id="id_formset-{{formsets.othernames.prefix}}" data-prefix="{{formsets.othernames.prefix}}">
                    {{formsets.othernames.management_form}}
                    {% for f in formsets.othernames %}
                        <div class="control-group form-inline {% if f.errors %}error{% endif %}"
                                id="id_form-{{f.prefix}}" data-prefix="{{f.prefix}}">
                            <label for="id_{{f.prefix}}-{{f.name.name}}">{% if forloop.first %}Alternate Name{% endif %}</label>
                            <div class="controls inlinemulti">
                                {{f.id}}
                                {{f.name}}
                                {{f.DELETE}}
                                {{f.DELETE.label_tag}}
                                {% if f.errors %}
                                    <span class="help-inline">{{f.errors}}</span>
                                {% endif %}
                            </div>
                        </div>
                    {% endfor %}
                </div>

                {% include "_form_field.html" with field=form.type_of_entity %}
            </fieldset>
            <fieldset>
                <legend>Contact Area</legend>
                <div class="contact-formset" id="id_formset-{{formsets.contacts.prefix}}" data-prefix="{{formsets.contacts.prefix}}">
                    {{formsets.contacts.management_form}}
                    {% for f in contacts %}
                        <div class="control-group form-inline {% if f.errors %}error{% endif %}"
                            id="id_form-{{f.prefix}}" data-prefix="{{f.prefix}}">
                            {{ f|as_bootstrap }}
                        </div>
                    {% endfor %}
                </div>
            </fieldset>

            <fieldset>
                <legend>Description Area</legend>
                {% include "_form_field.html" with field=form.history %}
                {% include "_form_field.html" with field=form.geocultural_context %}
                {% include "_form_field.html" with field=form.mandates %}
                {% include "_form_field.html" with field=form.internal_structures %}
                {% include "_form_field.html" with field=form.collecting_policies %}
                {% include "_form_field.html" with field=form.buildings %}
                {% include "_form_field.html" with field=form.holdings %}
                {% include "_form_field.html" with field=form.finding_aids %}
            </fieldset>

            <fieldset>
                <legend>Access Area</legend>
                {% include "_form_field.html" with field=form.opening_times %}
                {% include "_form_field.html" with field=form.access_conditions %}
                {% include "_form_field.html" with field=form.accessibility %}
            </fieldset>

            <fieldset>
                <legend>Services Area</legend>
                {% include "_form_field.html" with field=form.research_services %}
                {% include "_form_field.html" with field=form.reproduction_services %}
                {% include "_form_field.html" with field=form.public_areas %}
            </fieldset>

            <fieldset>
                <legend>Control Area</legend>
                {% include "_form_field.html" with field=form.description_identifier %}
                {% include "_form_field.html" with field=form.institution_identifier %}
                {% include "_form_field.html" with field=form.rules %}
                {% include "_property_form_field.html" with propform=formsets.language name="Language" %}
                {% include "_property_form_field.html" with propform=formsets.script name="Script" %}
                {% include "_form_field.html" with field=form.sources %}
            </fieldset>

            <div class="form-actions">
                <button type="submit" class="btn btn-primary">Save Changes</button>
                <a class="btn" href="{{object.get_absolute_url}}">Cancel</a>
            </div>
        </form>
    </div>
</div>
{% endblock %}
